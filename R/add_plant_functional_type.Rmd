---
title: "Add Plant Functional Type (PFT) labels"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages, message=FALSE}
library(tidyverse)
library(here)
library(dplyr)
library(kableExtra)
library(neonUtilities)
```

This script adds plant functional type labels to NEON spectra based on known scientific name. I explored R packages to automate this (BIEN, Taxise, USDA plants) without success, so the code below manually adds labels of interest for *Genus species* names.

This code manually adds labels to each taxon (genus and species listed here) for: 

- **commonName**
- **pft_MRA** (Plant Functional Type based on Macrosystems proposed labels)
    - coniferous_forest
    - deciduous_forest
    - woody_shrub
    - grass_herb
    bare_ground
- **pft_MODIS** (Plant Functional type based on MODIS land cover classes)
    - evergreen-needleleaf_forest
    - evergreen-broadleaf_forest
    - deciduous-needleleaf_forest
    - deciduous-broadleaf_forest
    - shrub
- **phenology** (evergreen or deciduous)
- **leafType** (broadleaf or needleleaf)
- **growthForm** (shrub or tree, based on NEON field based observations)

I searched for each taxon on USDA plants and determined the phenology and leaf type. Some tips from botany friend Adam Mahood:

- shrubs that are angiosperms are broadleaf
- group = dicot or monocot, you can say broadleaf
- group = gymnosperm will be needleleaf


## Download NEON data

The NEON Woody Vegetation Structure vst_apparentindividual data table contains growthform observations for each individual plant. Since some species can be designated as trees OR shrubs, lets' look at the NEON observations and use whichever growth form is most often observed for each taxon. 

```{r load_cleaned_spectra, message=FALSE}
# start timer 
start_time <- Sys.time()

# read cleaned spectral library file 
cleaned_spectra <- read_csv(here::here("analysis", "data", "derived_data", "cleaned_spectra.csv"))
```

Run this code chunk to download the NEON woody vegetation structure data: 
```{r download_neon_veg_data, warning=FALSE, message=FALSE, eval=FALSE}
# download woody vegetation structure data for all sites and years 
out_dir <- here::here("analysis","data","raw_data")

neonUtilities::zipsByProduct(dpID = "DP1.10098.001",
              savepath = out_dir,
              check.size = FALSE)

stackByTable(file.path(out_dir, "filesToStack10098"), folder = TRUE)
```

```{r read_merge_simplify_growthforms}
# read the vst_apparentindividual table, which has growthForm data
vst_apparentindividual <- read_csv(out_dir <- here::here("analysis","data","raw_data", "filesToStack10098",
                                                         "stackedFiles", "vst_apparentindividual.csv"), 
                                   col_types = cols())

# select the growthForm and height columns
growthForms <- vst_apparentindividual %>% 
  select(individualID, growthForm, height)

# join the growthForm and height columns into the spectra data frame
cleaned_spectra_merged <- right_join(cleaned_spectra, growthForms, by = "individualID")

# print all unique growthForm values 
unique(cleaned_spectra_merged$growthForm)


# simplify the growth form into "tree", "shrub", "sapling" etc.  
cleaned_spectra_merged <- cleaned_spectra_merged %>% 
  rowwise() %>%
  # parse out the last word in each entry's growthForm
  # make this code more efficient????? 
  mutate(growthForm_simple = rev(strsplit(growthForm, " ")[[1]])[1])
```

```{r summary_table_taxon_growthforms}
# summarize the merged growthform data
cleaned_spectra_merged %>% 
  distinct(spectraID, .keep_all = TRUE) %>% 
  group_by(genusSpecies, growthForm_simple) %>% 
    tally() 

# summarize the merged growthform data with "tree" and "shrub" growth forms
cleaned_spectra_merged %>% 
  distinct(spectraID, .keep_all = TRUE) %>% 
  # keep just the tree and shrub growth forms, remove rows with "sampling" and "liana"
  filter(growthForm_simple %in% c("tree","shrub")) %>% 
  group_by(genusSpecies, growthForm_simple) %>% 
    tally() %>% 
  # display as a nicely formatted table
  kableExtra::kable() %>% 
  kableExtra::kable_styling(bootstrap_options = "striped", 
                            full_width = F, 
                            position = "left")
```


## Manually add PFTs to spectral library

```{r manually_add_pft_labels}
# list unique taxon labels, add an empty columns to fill with plant functional type (PFT) and common name labels.
taxon_pft_lookup <- data.frame(genusSpecies = unique(cleaned_spectra$genusSpecies),
                               family = NA,
                               commonName = NA,
                               pft_MRA = NA,
                               pft_MODIS = NA,
                               phenology = NA,
                               leafType = NA,
                               growthForm = NA,
                               comments = "") %>% 
  # arrange alphabetically
  dplyr::arrange(genusSpecies)

for(i in 1:nrow(taxon_pft_lookup)){
  # print row and current genusSpecies label
  #print(i)
  genusSpecies <- taxon_pft_lookup$genusSpecies[i]
  #print(genusSpecies)
  
  if(genusSpecies == "Abies amabilis"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest" 
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Pacific silver fir"
    taxon_pft_lookup$family[i] = "Pinaceae"} 
  
  else if(genusSpecies == "Abies balsamea"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest" 
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "balsam fir"
    taxon_pft_lookup$family[i] = "Pinaceae"}
  
  else if(genusSpecies == "Abies lasiocarpa"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "subalpine fir"
    taxon_pft_lookup$family[i] = "Pinaceae"}
  
  else if(genusSpecies == "Acacia greggii"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub" 
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "catclaw acacia"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer barbatum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Southern sugar maple"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer circinatum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest" 
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "vine maple"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer negundo"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "boxelder"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer pensylvanicum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "striped maple"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer rubrum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "red maple"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer saccharinum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "silver maple"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Acer saccharum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sugar maple"
    taxon_pft_lookup$family[i] = "Aceraceae"}
  
  else if(genusSpecies == "Ailanthus altissima"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "tree of heaven"
    taxon_pft_lookup$family[i] = "Simaroubaceae"}
  
  else if(genusSpecies == "Alnus rubra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "red alder"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Aloysia wrightii"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "Wright's beebrush"
    taxon_pft_lookup$family[i] = "Verbenaceae"}
  
  else if(genusSpecies == "Amelanchier laevis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Allegheny serviceberry"
    taxon_pft_lookup$family[i] = "Rosaceae"}
  
  else if(genusSpecies == "Amyris elemifera"){
    taxon_pft_lookup$pft_MRA[i] = "NA" # is not deciduous or coniferous forest
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sea torchwood"
    taxon_pft_lookup$family[i] = "Rutaceae"}
  
  else if(genusSpecies == "Artemisia tridentata"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "big sagebrush"
    taxon_pft_lookup$family[i] = "Asteraceae"}
  
  else if(genusSpecies == "Atriplex canescens"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "fourwing saltbush"
    taxon_pft_lookup$family[i] = "Chenopodiaceae"}
  
  else if(genusSpecies == "Atriplex confertifolia"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "shadscale saltbush"
    taxon_pft_lookup$family[i] = "Chenopodiaceae"}
  
  else if(genusSpecies == "Betula alleghaniensis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "yellow birch"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Betula lenta"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sweet birch"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Betula neoalaskana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "resin birch"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Betula nigra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "river birch"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Betula papyrifera"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "paper birch"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Betula sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "birch"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Bourreria sp."){
    taxon_pft_lookup$pft_MRA[i] = "NA"
    taxon_pft_lookup$pft_MODIS[i] = "NA"
    taxon_pft_lookup$phenology[i] = "NA"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "strongbark"
    taxon_pft_lookup$family[i] = "Boraginaceae"
    taxon_pft_lookup$comments[i] = "varied genus"}
  
  else if(genusSpecies == "Bursera simaruba"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"  
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "gumbo limbo"
    taxon_pft_lookup$family[i] = "Burseraceae"}
  
  else if(genusSpecies == "Carpinus caroliniana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American hornbeam"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Carya aquatica"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "water hickory"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Carya cordiformis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "bitternut hickory"
    taxon_pft_lookup$family[i] = "Juglandaceae"}

  else if(genusSpecies == "Carya glabra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "pignut hickory"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Carya illinoinensis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "pecan"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Carya ovalis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "red hickory"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Carya ovata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "shagbark hickory"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Carya tomentosa"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "mockernut hickory"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Celtis laevigata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sugarberry"
    taxon_pft_lookup$family[i] = "Ulmaceae"}
  
  else if(genusSpecies == "Celtis occidentalis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "common hackberry"
    taxon_pft_lookup$family[i] = "Ulmaceae"}
  
  else if(genusSpecies == "Cercis canadensis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "eastern redbud"
    taxon_pft_lookup$family[i] = "Fabaceae"}
  
  else if(genusSpecies == "Chrysothamnus viscidiflorus"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "yellow rabbitbrush"
    taxon_pft_lookup$family[i] = "Asteraceae"}
  
  else if(genusSpecies == "Cordia collococca"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "red manjack"
    taxon_pft_lookup$family[i] = "Boraginaceae"}
  
  else if(genusSpecies == "Cornus drummondii"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub" 
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "roughleaf dogwood"
    taxon_pft_lookup$family[i] = "Cornaceae"}
  
  else if(genusSpecies == "Cornus florida"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "flowering dogwood"
    taxon_pft_lookup$family[i] = "Cornaceae"}

  else if(genusSpecies == "Corylus cornuta"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub" 
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "beaked hazelnut"
    taxon_pft_lookup$family[i] = "Betulaceae"}
  
  else if(genusSpecies == "Diospyros virginiana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "common persimmon"
    taxon_pft_lookup$family[i] = "Ebenaceae"}
  
  else if(genusSpecies == "Ephedra trifurca"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "longleaf jointfir"
    taxon_pft_lookup$family[i] = "Ephedraceae"}
  
  else if(genusSpecies == "Ericameria laricifolia"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "turpentine bush"
    taxon_pft_lookup$family[i] = "Asteraceae"}
  
  else if(genusSpecies == "Exostema caribaeum"){
    taxon_pft_lookup$pft_MRA[i] = "NA"  # not deciduous or coniferous
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Caribbean princewood"
    taxon_pft_lookup$family[i] = "Rubiaceae"}
  
  else if(genusSpecies == "Fagus grandifolia"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American beech"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Frangula purshiana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"    
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Cascara buckthorn"
    taxon_pft_lookup$family[i] = "Rhamnaceae"}
  
  else if(genusSpecies == "Fraxinus americana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "white ash"
    taxon_pft_lookup$family[i] = "Oleaceae"}
  
  else if(genusSpecies == "Fraxinus nigra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "black ash"
    taxon_pft_lookup$family[i] = "Oleaceae"}
  
  else if(genusSpecies == "Fraxinus pennsylvanica"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "green ash"
    taxon_pft_lookup$family[i] = "Oleaceae"}
  
  else if(genusSpecies == "Fraxinus sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "ash"
    taxon_pft_lookup$family[i] = "Oleaceae"}

  else if(genusSpecies == "Gaultheria shallon"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "salal"
    taxon_pft_lookup$family[i] = "Ericaceae"}
  
  else if(genusSpecies == "Gleditsia triacanthos"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "honey locust"
    taxon_pft_lookup$family[i] = "Fabaceae"}
  
  else if(genusSpecies == "Gutierrezia sarothrae"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "broom snakeweed"
    taxon_pft_lookup$family[i] = "Asteraceae"}
  
  else if(genusSpecies == "Halesia sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "silverbell"
    taxon_pft_lookup$family[i] = "Styracaceae"}
  
  else if(genusSpecies == "Hamamelis virginiana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American witchhazel"
    taxon_pft_lookup$family[i] = "Hamamelidaceae"}
  
  else if(genusSpecies == "Ilex montana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "mountain holly"
    taxon_pft_lookup$family[i] = "Aquifoliaceae"}
  
  else if(genusSpecies == "Ilex opaca"){
    taxon_pft_lookup$pft_MRA[i] = "NA"  # not deciduous or coniferous 
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American holly"
    taxon_pft_lookup$family[i] = "Aquifoliaceae"}
  
  else if(genusSpecies == "Juglans nigra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "black walnut"
    taxon_pft_lookup$family[i] = "Juglandaceae"}
  
  else if(genusSpecies == "Juniperus osteosperma"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Utah juniper"
    taxon_pft_lookup$family[i] = "Cupressaceae"
    taxon_pft_lookup$comments[i] = "scale-like needle leaves"}

  else if(genusSpecies == "Juniperus virginiana"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf" 
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "red cedar"
    taxon_pft_lookup$family[i] = "Cupressaceae"
    taxon_pft_lookup$comments[i] = "scale-like needle leaves"}
  
  else if(genusSpecies == "Larix sp."){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "larch"
    taxon_pft_lookup$family[i] = "Pinaceae"
    taxon_pft_lookup$comments[i] = "unusual genus with deciduous conifers"}
  
  else if(genusSpecies == "Larrea tridentata"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "creosote bush"
    taxon_pft_lookup$family[i] = "Zygophyllaceae"}
  
  else if(genusSpecies == "Liquidambar styraciflua"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sweetgum"
    taxon_pft_lookup$family[i] = "Hamamelidaceae"}
  
  else if(genusSpecies == "Liriodendron tulipifera"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "tuliptree"
    taxon_pft_lookup$family[i] = "Magnoliaceae"}
  
  else if(genusSpecies == "Lonicera maackii"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "Amur honeysuckle"
    taxon_pft_lookup$family[i] = "Caprifoliaceae"}
  
  else if(genusSpecies == "Maclura pomifera"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree" 
    taxon_pft_lookup$commonName[i] = "Osage-orange"
    taxon_pft_lookup$family[i] = "Moraceae"}
  
 else if(genusSpecies == "Magnolia sp."){
    taxon_pft_lookup$pft_MRA[i] = "NA"
    taxon_pft_lookup$pft_MODIS[i] = "NA"
    taxon_pft_lookup$phenology[i] = "NA"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "NA"
    taxon_pft_lookup$commonName[i] = "magnolia"
    taxon_pft_lookup$family[i] = "Magnoliaceae"
    taxon_pft_lookup$comments[i] = "varied genus with both deciduous and evergreen trees and shrubs"}
  
  else if(genusSpecies == "Mahonia nervosa"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "Cascade barberry"
    taxon_pft_lookup$family[i] = "Berberidaceae"}
  
  else if(genusSpecies == "Mangifera indica"){
    taxon_pft_lookup$pft_MRA[i] = "NA" # not coniferous or deciduous
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "mango"
    taxon_pft_lookup$family[i] = "Anacardiaceae"}
  
  else if(genusSpecies == "Melia azedarach"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Chinaberrytree"
    taxon_pft_lookup$family[i] = "Meliaceae"}
  
  else if(genusSpecies == "Morus rubra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "red mulberry"
    taxon_pft_lookup$family[i] = "Moraceae"}
  
  else if(genusSpecies == "Nyssa aquatica"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "water tupelo"
    taxon_pft_lookup$family[i] = "Cornaceae"}
  
  else if(genusSpecies == "Nyssa biflora"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "swamp tupelo"
    taxon_pft_lookup$family[i] = "Cornaceae"}
  
  else if(genusSpecies == "Nyssa sylvatica"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "blackgum"
    taxon_pft_lookup$family[i] = "Cornaceae"}
  
  else if(genusSpecies == "Oxydendrum sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sourwood"
    taxon_pft_lookup$family[i] = "Ericaceae"}

  else if(genusSpecies == "Picea engelmannii"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Engelmann spruce"
    taxon_pft_lookup$family[i] = "Picea mariana"}
  
  else if(genusSpecies == "Picea glauca"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "white spruce"
    taxon_pft_lookup$family[i] = "Picea mariana"}
  
  else if(genusSpecies == "Picea mariana"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "black spruce"
    taxon_pft_lookup$family[i] = "Picea mariana"}
  
  else if(genusSpecies == "Picea sp."){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "spruce"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus contorta"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "lodgepole pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus echinata"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "shortleaf pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus flexilis"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "limber pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus palustris"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "longleaf pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus ponderosa"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "ponderosa pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus sp."){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus strobus"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "eastern white pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pinus taeda"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "loblolly pine"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Pisonia albida"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "corcho bobo"
    taxon_pft_lookup$family[i] = "Nyctaginaceae"}

  else if(genusSpecies == "Platanus occidentalis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American sycamore"
    taxon_pft_lookup$family[i] = "Platanaceae"}
  
  else if(genusSpecies == "Populus deltoides"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "eastern cottonwood"
    taxon_pft_lookup$family[i] = "Salicaceae"}

  else if(genusSpecies == "Populus grandidentata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "bigtooth aspen"
    taxon_pft_lookup$family[i] = "Salicaceae"}

  else if(genusSpecies == "Populus sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "cottonwood"
    taxon_pft_lookup$family[i] = "Salicaceae"}
  
  else if(genusSpecies == "Populus tremuloides"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "quaking aspen"
    taxon_pft_lookup$family[i] = "Salicaceae"}
  
  else if(genusSpecies == "Prosopis glandulosa"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "honey mesquite"
    taxon_pft_lookup$family[i] = "Fabaceae"}
  
  else if(genusSpecies == "Prosopis velutina"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub" 
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "velvet mesquite"
    taxon_pft_lookup$family[i] = "Fabaceae"}
  
  else if(genusSpecies == "Prunus americana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American plum"
    taxon_pft_lookup$family[i] = "Rosaceae"}
  
  else if(genusSpecies == "Prunus angustifolia"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub" 
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "Chickasaw plum"
    taxon_pft_lookup$family[i] = "Rosaceae"}
  
  else if(genusSpecies == "Prunus mexicana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Mexican plum"
    taxon_pft_lookup$family[i] = "Rosaceae"}

  else if(genusSpecies == "Prunus serotina"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "black cherry"
    taxon_pft_lookup$family[i] = "Rosaceae"}
  
  else if(genusSpecies == "Pseudotsuga menziesii"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Douglas-fir"
    taxon_pft_lookup$family[i] = "Pinaceae"}
  
  else if(genusSpecies == "Quercus alba"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "white oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus coccinea"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "scarlet oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus falcata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "southern red oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}

  else if(genusSpecies == "Quercus geminata"){
    taxon_pft_lookup$pft_MRA[i] = "NA"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sand live oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus hemisphaerica"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Darlington oak"
    taxon_pft_lookup$comments[i] = "semi-evergreen or tardily deciduous"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus laevis"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "turkey oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus laurifolia"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "laurel oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus lyrata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "overcup oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus macrocarpa"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "bur oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus margaretta"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sand post oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus marilandica"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "blackjack oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}

  else if(genusSpecies == "Quercus michauxii"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "swamp chestnut oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus montana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "chestnut oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus muehlenbergii"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "chinquapin oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus nigra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "water oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus pagoda"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "cherrybark oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus phellos"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "willow oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus rubra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "northern red oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus shumardii"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Shumard's oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus sp."){
    taxon_pft_lookup$pft_MRA[i] = "NA"
    taxon_pft_lookup$pft_MODIS[i] = "NA"
    taxon_pft_lookup$phenology[i] = "NA"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "oak"
    taxon_pft_lookup$family[i] = "Fagaceae"
    taxon_pft_lookup$comments[i] = "varied genus with both deciduous and evergreen species"}
  
  else if(genusSpecies == "Quercus stellata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "post oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus velutina"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "black oak"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Quercus virginiana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "live oak"
    taxon_pft_lookup$comments[i] = "semi-deciduous"
    taxon_pft_lookup$family[i] = "Fagaceae"}
  
  else if(genusSpecies == "Rhamnus davurica"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "Dahurian buckthorn"
    taxon_pft_lookup$family[i] = "Rhamnaceae"}
  
  else if(genusSpecies == "Rhus aromatica"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "fragrant sumac"
    taxon_pft_lookup$family[i] = "Anacardiaceae"}
  
  else if(genusSpecies == "Rhus glabra"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "smooth sumac"
    taxon_pft_lookup$family[i] = "Anacardiaceae"}
  
  else if(genusSpecies == "Robinia pseudoacacia"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "black locust"
    taxon_pft_lookup$family[i] = "Fabaceae"}
  
  else if(genusSpecies == "Sassafras albidum"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sassafras"
    taxon_pft_lookup$family[i] = "Lauraceae"}
  
  else if(genusSpecies ==  "Sassafras sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sassafras"
    taxon_pft_lookup$family[i] = "Lauraceae"}
  
  else if(genusSpecies == "Sideroxylon lanuginosum"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "gum bully"
    taxon_pft_lookup$comments[i] = "deciduous to semi-evergreen"
    taxon_pft_lookup$family[i] = "Sapotaceae"}
  
  else if(genusSpecies == "Symplocos sp."){
    taxon_pft_lookup$pft_MRA[i] = "NA"
    taxon_pft_lookup$pft_MODIS[i] = "NA"
    taxon_pft_lookup$phenology[i] = "NA"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "sweetleaf"
    taxon_pft_lookup$family[i] = "Symplocaceae"
    taxon_pft_lookup$comments[i] = "varied genus"}
  
  else if(genusSpecies == "Taxus brevifolia"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Pacific yew"
    taxon_pft_lookup$family[i] = "Taxaceae"}
  
  else if(genusSpecies == "Tetradium daniellii"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "bee-bee tree"
    taxon_pft_lookup$family[i] = "Rutaceae"}
  
  else if(genusSpecies == "Triadica sebifera"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "Chinese tallow"
    taxon_pft_lookup$family[i] = "Euphorbiaceae"}
  
  else if(genusSpecies == "Tsuga canadensis"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "eastern hemlock"
    taxon_pft_lookup$family[i] = "Pinaceae"}

  else if(genusSpecies == "Tsuga heterophylla"){
    taxon_pft_lookup$pft_MRA[i] = "coniferous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "evergreen-needleleaf_forest"
    taxon_pft_lookup$phenology[i] = "evergreen"
    taxon_pft_lookup$leafType[i] = "needleleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "western hemlock"
    taxon_pft_lookup$family[i] = "Pinaceae"}
  
  else if(genusSpecies == "Ulmus alata"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "winged elm"
    taxon_pft_lookup$family[i] = "Ulmaceae"}

  else if(genusSpecies == "Ulmus americana"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "American elm"
    taxon_pft_lookup$family[i] = "Ulmaceae"}  
  
  else if(genusSpecies == "Ulmus crassifolia"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "cedar elm"
    taxon_pft_lookup$family[i] = "Ulmaceae"}
  
  else if(genusSpecies == "Ulmus rubra"){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "slippery elm"
    taxon_pft_lookup$family[i] = "Ulmaceae"}

  else if(genusSpecies == "Ulmus sp."){
    taxon_pft_lookup$pft_MRA[i] = "deciduous_forest"
    taxon_pft_lookup$pft_MODIS[i] = "deciduous-broadleaf_forest"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "tree"
    taxon_pft_lookup$commonName[i] = "elm"
    taxon_pft_lookup$comments[i] = "varied genus contains some semi-deciduous or evergreen species"
    taxon_pft_lookup$family[i] = "Ulmaceae"}
  
  else if(genusSpecies == "Vaccinium parvifolium"){ 
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "red huckleberry"
    taxon_pft_lookup$family[i] = "Ericaceae"}
  
  else if(genusSpecies == "Zinnia acerosa"){
    taxon_pft_lookup$pft_MRA[i] = "woody_shrub"
    taxon_pft_lookup$pft_MODIS[i] = "shrub"
    taxon_pft_lookup$phenology[i] = "deciduous"
    taxon_pft_lookup$leafType[i] = "broadleaf"
    taxon_pft_lookup$growthForm[i] = "shrub"
    taxon_pft_lookup$commonName[i] = "desert zinnia"
    taxon_pft_lookup$family[i] = "Asteraceae"
    taxon_pft_lookup$comments[i] = "neon growthForm was shrub; evergreen but cold-deciduous"}

  # For taxons not described in this code
  #else #print("PFT unknown")
  
}

```

Let's check the unique values in each column.

```{r check_col_pftMRA}
# unique values in the pft_MRA column: 
print(unique(taxon_pft_lookup$pft_MRA))
```
```{r check_col_pftMODIS}
# unique values in the pft_MODIS column: 
print(sort(unique(taxon_pft_lookup$pft_MODIS)))
```
```{r check_col_phenology}
# unique values in the phenology column: 
print(unique(taxon_pft_lookup$phenology))
```
```{r check_col_leafType}
# unique values in the leafType column: 
print(unique(taxon_pft_lookup$leafType))
```
```{r check_col_growthForm}
# unique values in the growthForm column: 
print(unique(taxon_pft_lookup$growthForm))
```

```{r check_col_comments}
# unique values in the comments column: 
print(unique(taxon_pft_lookup$comments))
```

```{r check_col_family}
# unique values in the family column: 
print(unique(taxon_pft_lookup$family))
```

```{r taxon_pft_table}
kableExtra::kable(taxon_pft_lookup) %>% 
  kableExtra::kable_styling(bootstrap_options = "striped")
```

```{r write_csv}
# write the lookup table to a csv 
write_csv(x = taxon_pft_lookup,
          file = here::here("analysis", "data", "derived_data","taxon_pft_lookup.csv"))
```


## Add PFT label to each spectrum

```{r add_pft_labels}
# select the columns to merge with all the spectra
pft_labels <- taxon_pft_lookup %>% 
  select(genusSpecies, commonName, pft_MRA, pft_MODIS, phenology, leafType, growthForm, family)

# join the PFT labels into the spectral data frame
cleaned_spectra_pft <- right_join(cleaned_spectra, pft_labels, by = "genusSpecies")

# reorder the columns 
cleaned_spectra_pft <- cleaned_spectra_pft %>% 
  dplyr::relocate(scientificName, family, genus, species, genusSpecies, 
                  commonName, growthForm, phenology, leafType, 
                  pft_MRA, pft_MODIS, .after = last_col())

# write to a csv
write_csv(x = cleaned_spectra_pft,
          file = here::here("analysis", "data","derived_data", "cleaned_spectra_pft.csv"))
```






## R packages: attempting to automate PFT labeling

### USDA Plants Database

USDA Plants Database R API tutorial: https://recology.info/2016/10/usda-plants-database-r/ 

The USDA maintains a database of plant information, some of it trait data, some of it life history: http://plants.usda.gov/java/

### BIEN 

RBIEN tutorial: https://cmerow.github.io/RDataScience/3_3_RBIEN_tutorial.html

### TRY Database

https://www.try-db.org/TryWeb/Home.php

### Taxize

https://www.rdocumentation.org/packages/taxize/versions/0.9.99


Time the code. How long did this take? 
```{r how_long_did_this_take}
# stop timer
end_time <- Sys.time()

elapsed_time <- end_time - start_time

print(difftime(end_time, start_time, 
         units = c("auto", "secs", "mins", "hours",
                   "days", "weeks")))
```


